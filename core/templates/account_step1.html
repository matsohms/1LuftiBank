<!-- core/templates/account_step1.html -->
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Konto anlegen – Schritt 1</title>
  <style>
    /* … dein bestehendes CSS … */
    .currency::after { content: " LUF"; }
    .percent::after  { content: "%"; }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Umschalter Pauschal/Prozent
      const costWithinType = document.getElementById('cost_within_type');
      const costWithinVal  = document.getElementById('id_cost_within');
      costWithinType.addEventListener('change', () => {
        if (costWithinType.checked) {
          costWithinVal.classList.remove('percent');
          costWithinVal.classList.add('currency');
        } else {
          costWithinVal.classList.remove('currency');
          costWithinVal.classList.add('percent');
        }
      });
      // Formatierung bei Blur
      document.querySelectorAll('input[type=number]').forEach(input => {
        input.addEventListener('blur', () => {
          let v = parseFloat(input.value);
          if (isNaN(v)) return;
          if (input.classList.contains('currency')) {
            input.value = v.toLocaleString('de-DE', { minimumFractionDigits: 2 });
          } else if (input.classList.contains('percent')) {
            input.value = v.toLocaleString('de-DE', { maximumFractionDigits: 2 }) + '%';
          }
        });
      });
    });
  </script>
</head>
<body>
  <div class="container">
    <h1>Schritt 1: Einstellungen für neues Konto</h1>
    <form method="post">{% csrf_token %}
      <div class="row">
        <label for="id_account_model">Kontomodell</label>
        {{ form.account_model }}
      </div>
      <div class="row">
        <label for="id_max_balance">Maximale Kontoauslastung</label>
        {{ form.max_balance }} <span>LUF</span>
      </div>
      <div class="row">
        <label>
          <input type="checkbox" id="free_within" name="free_within" checked>
          Kostenlose Überweisungen
        </label>
      </div>
      <div id="cost-block" class="row">
        <label for="id_free_up_to">Kostenpflichtig bis</label>
        {{ form.free_up_to }} <span>LUF</span>
        <br>
        <label>
          <input type="checkbox" id="cost_within_type">
          Pauschal (sonst Prozent)
        </label>
        <label for="id_cost_within">Kosten pro Überweisung</label>
        <input type="number" step="0.01" id="id_cost_within" name="cost_within" class="currency">
      </div>
      <!-- analoge Felder für free_above / cost_above… -->
      <button type="submit" class="btn-primary">Weiter</button>
      <a href="{% url 'customer_detail' customer.pk %}"><button type="button" class="btn-secondary">Abbrechen</button></a>
    </form>
  </div>
</body>
</html>

